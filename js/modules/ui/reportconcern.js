!function(e){"function"==typeof define&&define.amd?define("modules/ui/reportconcern",["jquery","background/concerndata","logger","i18n","modules/translate"],e):"object"==typeof exports&&(module.exports=e(require("jquery"),require("background/concerndata"),require("logger"),require("i18n"),require("modules/translate")))}(function(l,e,c,t,n,o){n();var s,d={load:function(){chrome.runtime.sendMessage({flush:!0}),document.getElementById("infoText").innerText=a.info+"\n\n"+a.detail,e.getContacts().then(function(e){(s=l("#contactContainer")).children().remove(),s=s[0],JSON.parse(e).map(r)}),e.getText().then(function(e){e.hasOwnProperty("help")&&(document.getElementById("helpText").innerText=e.help),e.hasOwnProperty("info")&&(document.getElementById("infoText").innerText="string"!=e.info?e.info:a.info+" "+a.detail)})},reportconcern:h},a={info:t("YOU_CAN_USE_TO_SHARE_A_CONCERN_BLURB"),detail:t("ENTER_CONCERN_DETAILS_BLURB")};window.addEventListener("resize",function(){window.resizeTo(localStorage.reportConcernWidth,localStorage.reportConcernHeight)});n=document.getElementById("customHeader"),t=document.getElementById("customFooter");n.style.backgroundColor=localStorage.customBackgroundColour,t.style.backgroundColor=localStorage.customBackgroundColour,document.getElementById("footerCustomSpan").innerHTML=localStorage.copyright;var i={concernData:null},g={message:void 0,name:void 0,contactid:void 0,document:void 0,filename:void 0};function r(e){var t=document.createElement("div"),n=document.createElement("div"),o=document.createElement("img"),a=document.createElement("h2"),i=document.createElement("h2");t.classList.add("contact"),n.classList.add("contact-details"),t.setAttribute("data-id",e.id),o.setAttribute("data-id",e.id),o.src="data:image/jpeg;base64,"+e.picture,a.innerText=null!=e.name?e.name:"",i.innerText=null!=e.jobtitle?e.jobtitle:"";var r=null!=e.name?e.name:"",e=null!=e.jobtitle?e.jobtitle:"";let l="";l=""!=r?r+"\n"+e:e,t.title=l,t.appendChild(o),t.appendChild(n),n.appendChild(a),n.appendChild(i),s.appendChild(t),o.addEventListener("click",m)}function m(){var e=document.getElementsByClassName("imageContactClicked");e&&e[0]&&e[0]!==this&&e[0].classList.toggle("imageContactClicked"),this.classList.toggle("imageContactClicked")}function p(){g.name=l("#concern-reporter").val(),g.message=l("#input").val();var e=document.getElementsByClassName("imageContactClicked")[0];e&&(g.contactid=e.getAttribute("data-id")),i.concernData=g}function u(){localStorage.removeItem("concern.name"),localStorage.removeItem("concern.message"),l("#concern-reporter").val(""),l("#concern-text").val("")}function h(e){e.preventDefault(),p(),0===g.message.length?l("#concern-text").focus():document.getElementsByClassName("imageContactClicked")[0]&&(navigator.onLine?(chrome.runtime.sendMessage({sendReportConcern:!0,concernData:i}),u(),window.close()):chrome.runtime.sendMessage({createWindow:!0,windowData:{url:"concerntryagainlater.html",focused:!0,type:"popup",width:600,height:120,left:parseInt((screen.width-600)/2),top:parseInt((screen.height-120)/4)}},function(){}))}function y(){c.debug("cancel"),u(),window.close()}return addEventListener("unload",function(e){e.preventDefault(),p(),localStorage["concern.name"]=g.name,localStorage["concern.message"]=g.message}),l("#input").keyup(function(){var e=l(this).val().length;l("#current").text(e+"/766")}),function(){var e=localStorage.displayWidth,t=localStorage.displayHeight;let n=document.getElementById("whatsConcerningYou"),o=document.getElementById("customHeader"),a=o.getElementsByTagName("label"),i=document.getElementById("detailsDiv"),r=document.getElementById("infoText");1920<=e&&1080<=t||(1680<=e&&1050<=t?(n.style.marginTop="3px",o.style.height="50px",a.height="40px",i.style.margintTop="10px",r.style.height="105px"):1600<=e&&900<=t?(n.style.marginTop="3px",o.style.height="50px",a.height="40px",i.style.margintTop="10px",r.style.height="98px"):1440<=e&&900<=t?(n.style.marginTop="3px",o.style.height="50px",a.height="40px",i.style.margintTop="10px",r.style.height="105px"):1400<=e&&1050<=t?(n.style.marginTop="3px",o.style.height="50px",a.height="40px",i.style.margintTop="18px",r.style.height="105px"):1366<=e&&768<=t||1360<=e&&768<=t?(n.style.marginTop="3px",o.style.height="50px",a.height="40px",i.style.margintTop="10px",r.style.height="76px"):1280<=e&&1024<=t?(n.style.marginTop="5px",o.style.height="45px",a.height="36px",i.style.margintTop="10px",r.style.height="76px"):1280<=e&&960<=t?(n.style.marginTop="15px",o.style.height="45px",a.height="36px",i.style.margintTop="20px",r.style.height="76px"):1280<=e&&800<=t&&(n.style.marginTop="5px",o.style.height="45px",a.height="36px",i.style.margintTop="10px",r.style.height="76px")),chrome.runtime.onMessage.addListener(function(e){1==e.updateWithPhotos&&d.load()}),c.info("setup"),document.getElementById("report").addEventListener("click",h),document.getElementById("cancel").addEventListener("click",y),g.name=localStorage["concern.name"],g.name&&l("#concern-reporter").val(g.name),g.message=localStorage["concern.message"],g.message&&l("#concern-text").val(g.message),l("#current").text("0/766"),d.load()}(),d});