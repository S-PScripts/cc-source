define(["modules/ciccore","modules/ciccrypto","background/messageQueue","modules/altdebug","modules/altdebug","models/useridentity","comms.websocket"],function(b,I,t,n,P,e,T){var O=[],c=[],g=[],d=[];const u="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";var l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a={register:R,updateregistrationdetails:function(e,t,a,o){null!=e&&(localStorage.accountID=e);null!=t&&(localStorage.siteID=t);null!=a&&(localStorage.region=a);{var r;null!=localStorage.macAddress&&null!=localStorage.serialNumber&&null!=localStorage.siteID&&null!=localStorage.accountID&&null!=localStorage.region&&(o=JSON.stringify(o),r=new XMLHttpRequest,C(localStorage.region)?r.open("POST",localStorage.region+"/api/Devices/registerDevice"):"nsclassroomapi"==localStorage.region?r.open("POST","https://nsclassroomapi.azurewebsites.net/api/Devices/registerDevice"):r.open("POST","https://api-"+localStorage.region+".classroom.cloud/api/Devices/registerDevice"),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.send(o),r.onreadystatechange=function(){this.readyState===r.DONE&&this.status},r.onerror=function(){n("Register device error")})}},config:f,isIpInvalid:J,cloudstate:function(){var e=new Date;CLOUDSTATE=""===localStorage.roomspec?"18":null!=localStorage.allowedConnectionIPs&&null!=localStorage.allowedConnectionIPs&&""!=localStorage.allowedConnectionIPs&&J(localStorage.ipaddress,localStorage.allowedConnectionIPs,"privacy")?"20":q(e,localStorage.alloweddates,localStorage.allowedtimes)?"21":"1";return CLOUDSTATE},esafetyConfig:p,activityMonitorConfig:s,esafetyTimeSettings:function(){var e=q(new Date,localStorage.esafetyAllowedDates,localStorage.esafetyAllowedTimes);localStorage.phrasematchEnabled="1"==localStorage.isPhrasematchEnabledFromEsafetyConfig&&0==e&&"18"!=localStorage.getItem("cloudState")},recalculateActivityMonitorSettings:function(){var e=q(new Date,localStorage.appAllowedDates,localStorage.appAllowedTimes);localStorage.isWebMonitoringAllowed="true"==localStorage.webEnabled&&"true"==localStorage.activityMonitorEnabled&&0==e&&S(localStorage.monitoredActivityMonitorIPs)&&"18"!=localStorage.getItem("cloudState"),localStorage.isLoginMonitoringAllowed="true"==localStorage.logEnabled&&"true"==localStorage.activityMonitorEnabled&&0==e&&S(localStorage.monitoredActivityMonitorIPs)&&"18"!=localStorage.getItem("cloudState")},reportConcernDialogConfig:o,resendUnsentAUPSignatures:function(){var e=localStorage.policiesUnsent,t=new XMLHttpRequest;C(localStorage.region)?t.open("POST",localStorage.region+"/api/Devices/sendAcceptableUsagePolicySignatures"):"nsclassroomapi"==localStorage.region?t.open("POST","https://nsclassroomapi.azurewebsites.net/api/Devices/sendAcceptableUsagePolicySignatures"):t.open("POST","https://api-"+localStorage.region+".classroom.cloud/api/Devices/sendAcceptableUsagePolicySignatures");t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("Accept","application/json"),t.send(e),t.onreadystatechange=function(){this.readyState===t.DONE&&204===this.status?localStorage.policiesUnsent=null:0==this.status&&(localStorage.policiesUnsent=e)}},shouldBlockSiteIternetRestrictions:function(e){return!(!localStorage.internetRestrictionsEnabled||"true"!=localStorage.internetRestrictionsEnabled)&&(!(!function(){{if(localStorage.termDatesIR){var e=JSON.parse(localStorage.termDatesIR);if(0<e.length){for(i=0;i<e.length;i++)if(td=e[i],1==function(e,t){let a=new Date(e),o=new Date(t),r=new Date(o.setHours(23,59,59,0)),n=new Date(a.setHours(0,0,0,0));t=new Date;return n<=t&&t<=r}(td.startDate,td.endDate))return!0;return!1}return!0}return!0}}()||J(localStorage.ipaddress,localStorage.internetRestrictedIPs,"internetrestrictions"))&&function(r){if(r.includes(chrome.runtime.id))return!1;if(r&&localStorage.whitelistedUrls){var t;for(t of localStorage.whitelistedUrls.split(",")){let e=r.replace(/^https?\:\/\//i,"");var a=t.replace(/^https?\:\/\//i,"").replace("*","");if(e.includes(a))return!1}}if(function(e){{if(localStorage.safeguardingresources){var t,a=localStorage.safeguardingresources,a=JSON.parse(a);const o=new URL("",e);for(t of a){const r=new URL("",t.Url);if(o.host.replace("www.","")==r.host.replace("www.","")||e==chrome.runtime.getURL("safeguardingresourceslist.html"))return!0}return!1}return!1}}(r)&&"true"==localStorage.allowSafeguardingResources)return!1;if(r&&localStorage.websitesIR){let a=JSON.parse(localStorage.websitesIR);a.sort(function(e,t){return t.websiteURL.length-e.websiteURL.length});let o="";for(i=0;i<a.length;i++){let e=a[i],t=r.replace(/^https?\:\/\//i,"");var n=e.websiteURL.replace(/^https?\:\/\//i,"");if(t.includes(n)){o=e.status;break}}var e=l[(new Date).getDay()];return""==o?!!h(e)||(!!A(e)||(D(e),!1)):"Approved"==o?!!h(e)||(A(e)||D(e),!1):"Restricted"==o?!!h(e)||(!!A(e)||!!D(e)):void 0}}(e))},getInternetRestrictionsConfig:E,getAcceptableUsagePolicyPreflight:m,storePolicySignature:r};function R(o,r,n,l,e){P.altdebug("52 registerDevice"),P.altdebug("53 registerDevice - isRepeat: "+o),chrome.runtime.sendMessage({IsManaged:!0},function(e){P.altdebug("57 registerDevice - isManagedResponse"),null!=r&&(localStorage.accountID=r),null!=n&&(localStorage.siteID=n),null!=l&&(localStorage.region=l);var t=e.manifest.version_name;localStorage.clientVersion=t,localStorage.regDevice=!0;var a,e={accountID:localStorage.accountID,siteID:localStorage.siteID,departmentID:"2",name:localStorage.serialNumber,clientVersion:t,osVersion:"ChromeOS",osVersionNumber:(t=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./))?parseInt(t[2],10).toString():"",sysEnclosure:"10",identifier:localStorage.macAddress,model:localStorage.model,manufacturer:localStorage.manufacturer,location:localStorage.location,assetTag:localStorage.deviceAssetId,IsManaged:e.isManaged,fullname:"true"==localStorage.googleAdminAccess&&"true"==localStorage.isManaged&&null!=localStorage.name?localStorage.name:localStorage.userName.split("@")[0].toUpperCase(),googleOrganisationalUnit:"true"==localStorage.googleAdminAccess&&"true"==localStorage.isManaged&&null!=localStorage.googleOrganisationalUnit?localStorage.googleOrganisationalUnit:""};P.altdebug("87 cicreg - Inside register device , data.IsManaged: "+e.IsManaged),null!=localStorage.macAddress&&null!=localStorage.serialNumber&&null!=localStorage.siteID&&null!=localStorage.accountID&&null!=localStorage.region&&(e=JSON.stringify(e),a=new XMLHttpRequest,C(localStorage.region)?a.open("POST",localStorage.region+"/api/Devices/registerDevice"):"nsclassroomapi"==localStorage.region?a.open("POST","https://nsclassroomapi.azurewebsites.net/api/Devices/registerDevice"):a.open("POST","https://api-"+localStorage.region+".classroom.cloud/api/Devices/registerDevice"),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Accept","application/json"),a.send(e),a.onreadystatechange=function(){this.readyState===a.DONE&&200===this.status&&(P.altdebug("135 reg success"),chrome.runtime.sendMessage({storeSync:!0,data:{deviceIsRegistered:!0}}),0==o&&f(a.responseText,localStorage.accountID,localStorage.region))},a.onerror=function(){P.altdebug("144 reg failed"),chrome.runtime.sendMessage({storeSync:!0,data:{deviceIsRegistered:!1}})})})}function C(e){return new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)}function H(e,t,a,o){var t=JSON.stringify({DeviceID:e,AccountID:t}),r=new XMLHttpRequest;P.altdebug("225 getTechConfig"),C(localStorage.region)||"nsclassroomapi"==localStorage.region?r.open("POST","https://nsclassroomtechnicianapi.azurewebsites.net/api/Devices/getConfig"):r.open("POST","https://technicianapi-"+localStorage.region+".classroom.cloud/api/Devices/getConfig"),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.send(t),r.onreadystatechange=function(){this.readyState===r.DONE&&200===this.status&&(P.altdebug("244 getTechConfig success"),function(e,t){chrome.runtime.sendMessage({updatePersistencePageInfo:!0}),P.altdebug("580 cicreg TECHN CONFIG: \n"+e);e=JSON.parse(e);localStorage.inventoryEnabled=e.inventoryEnabled,localStorage.digestHardwareHex=1==e.checkSums.hasOwnProperty("hardware")?e.checkSums.hardware:"",localStorage.digestSoftwareHex=1==e.checkSums.hasOwnProperty("software")?e.checkSums.software:"",s(localStorage.deviceID,localStorage.accountID,t)}(r.responseText,o))}}function o(e,t,a){var t={DeviceID:e,SafeguardingGroupID:parseInt(localStorage.sgroup),Configuration:t?32:16},t=JSON.stringify(t),o=new XMLHttpRequest;C(localStorage.region)||"nsclassroomapi"==localStorage.region?o.open("POST","https://nsclassroomsafeguardingapi.azurewebsites.net/api/configuration/config2/?version=1"):o.open("POST","https://safeguardingapi-"+localStorage.region+".classroom.cloud/api/configuration/config2/?version=1"),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","application/json"),o.send(t),o.onreadystatechange=function(){var e,t;this.readyState===o.DONE&&200===this.status&&(e=o.responseText,t=a,I.decrypt(e).then(function(e){!function(e,t){let a=null!=e.reportaconcern&&null!=e.reportaconcern.enabled?e.reportaconcern.enabled:"0",o=null!=e.reportaconcern&&null!=e.reportaconcern.contacts?e.reportaconcern.contacts:"",r=null!=e.reportaconcern&&null!=e.reportaconcern.dialogtext?e.reportaconcern.dialogtext:"",n={reportconcern:{dialogtext:r,EnableReportAConcern:a,ContactList:o,contacts:[]}},l=JSON.parse(o);for(i=0;i<l.length;i++){var s={id:l[i].ID,name:l[i].Name,jobtitle:l[i].JobTitle,picture:l[i].hasOwnProperty("Photo")?l[i].Photo:u};n.reportconcern.contacts.push(s)}localStorage.esafetyConfigData=JSON.stringify(n),function(t,a){require(["background/confighandler"],function(e){e.update(t,a)})}(n,t)}(JSON.parse(e),t)}))},o.onerror=function(){console.log(o),chrome.runtime.sendMessage({queryTabs:!0,tabData:{active:!0}},e=>{var t,a=!1;for(t of e)if(t.url===chrome.extension.getURL("concerntryagainlater.html")){a=!0;break}a||chrome.runtime.sendMessage({createWindow:!0,windowData:{url:"concerntryagainlater.html",focused:!0,type:"popup",width:600,height:120,left:parseInt((screen.width-600)/2),top:parseInt((screen.height-120)/4)}},function(){})})}}function p(e,t,a,o){var e={DeviceID:e,SafeguardingGroupID:parseInt(localStorage.sgroup),Configuration:15},e=JSON.stringify(e),r=new XMLHttpRequest;C(localStorage.region)||"nsclassroomapi"==localStorage.region?r.open("POST","https://nsclassroomsafeguardingapi.azurewebsites.net/api/configuration/config2/?version=1"):r.open("POST","https://safeguardingapi-"+localStorage.region+".classroom.cloud/api/configuration/config2/?version=1"),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.send(e),r.onreadystatechange=function(){var e,t;this.readyState===r.DONE&&200===this.status&&(e=r.responseText,t=o,I.decrypt(e).then(function(e){!function(e,t){P.altdebug("604 cicreg ESAFETY CONFIG: \n"+JSON.stringify(e));var a=e.resources;var o="1"==a.enabled;localStorage.isSafeguardingResourcesEnabled=o,localStorage.excludefromphrasemonitoring="1"==a.excludefromphrasemonitoring;let r=e.resources.resources,n=e.phrasematch,l=null!=e.reportaconcern&&null!=e.reportaconcern.enabled?e.reportaconcern.enabled:"0",s=n.customphrases,c=n.predefinedphrases,g=n.allowedips,d=n.allowedtimes,u=n.alloweddates,p=n.langpacks;localStorage.langpacks=p,localStorage.esafetyAllowedTimes=d,localStorage.esafetyAllowedDates=u,localStorage.monitoredEsafetyIPs=g;var S=n.enabled,f=q(new Date,u,d),m=n.excludedwebsites,v=n.recordinglength,y=n.sources,h=n.threshold,A=n.lowpriorityaction,o=n.mediumpriorityaction,a=n.highpriorityaction,e=n.urgentpriorityaction;localStorage.isPhrasematchEnabledFromEsafetyConfig=S,localStorage.recordinglength=v,localStorage.phraseSources=y,localStorage.threshold=h,localStorage.excludedwebsites=m,localStorage.phrasematchEnabled="1"==S&&0==f&&"18"!=localStorage.getItem("cloudState");var D=[];if(null!=s){var w=s.split("|");for(i=0;i<w.length;i+=3){var b=w[i],I=N(parseInt(w[i+1])),T=w[i+2];tmp={phrase:b,category:I,priority:T},D.push(tmp)}}if(null!=c){var E=c.split("|");for(i=0;i<E.length;i+=3){b=E[i],I=N(parseInt(E[i+1])),T=E[i+2];tmp={phrase:b,category:parseInt(I),priority:parseInt(T)},D.push(tmp)}}h={esafety:{enabled:1,frequency:10,runatstartup:1,phraselist:D,LowPriorityAction:A,MediumPriorityAction:o,HighPriorityAction:a,UrgentPriorityAction:e,Threshold:h,LanguageFiles:p,SafegurdingReources:r,EnableReportAConcern:l}};localStorage.esafetyConfigData=JSON.stringify(h),null!=r&&function(e){var t=JSON.parse(e),e=t.length;!function o(r,n,l){if(n<l){var e=r[n].Url;const a=document.createElement("a");a.setAttribute("href",e);var e={url:a.host},e=JSON.stringify(e),s=new XMLHttpRequest;C(localStorage.region)||"nsclassroomapi"==localStorage.region?s.open("POST","https://nscfunctions.azurewebsites.net/api/favicon"):s.open("POST","https://functions-"+localStorage.region+".classroom.cloud/api/favicon"),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Accept","application/json"),s.send(e),s.onreadystatechange=function(){if(this.readyState===s.DONE&&(200===this.status||204===this.status)&&n<l){var t,a="";""!=s.responseText&&(t=JSON.parse(s.responseText),a=t.iconData),O[n]=a;let e=n+1;o(r,e,l)}}}else{var t=[];for(i=0;i<O.length;i++)tmp={favIcon:O[i]},t.push(tmp);localStorage.faviconArray=JSON.stringify(t)}}(t,0,e)}(r);(function(t){require(["background/confighandler"],function(e){e.update(t,!1)})})(h),"true"==localStorage.googleAdminAccess&&"true"==localStorage.isManaged?(P.altdebug("721 Google Admin Access granted AND is MANAGED"),function(e){P.altdebug("728 retrieveAdditionalDeviceInfo");var t={accountID:localStorage.accountID,deviceId:localStorage.deviceID,identifier:localStorage.macAddress,emailAddress:localStorage.fullemail},t=JSON.stringify(t),a=new XMLHttpRequest;C(localStorage.region)?a.open("POST",localStorage.region+"/api/devices/getGoogleDeviceInformation"):"nsclassroomapi"==localStorage.region?a.open("POST","https://nsclassroomapi.azurewebsites.net/api/devices/getGoogleDeviceInformation"):a.open("POST","https://api-"+localStorage.region+".classroom.cloud/api/devices/getGoogleDeviceInformation");a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Accept","application/json"),a.send(t),a.onreadystatechange=function(){this.readyState===a.DONE&&200===this.status&&function(e,t){P.altdebug("763 cicreg ADDITIONAL DEVICE  INFO: \n"+e);var a=JSON.parse(e);{var o,r,n,l,i,s;0!=Object.keys(a).length&&(s=a.device,o=s.model,r=s.manufacturer,n=s.totalStorage,l=s.freeSpace,i=s.autoUpdateExpiration,e=s.lastOSCheck,s=s.orgUnitPath,a=a.user.name,localStorage.name=a,localStorage.manufacturer=r,localStorage.model=o,localStorage.totalStorage=null!=n?parseFloat(n).toFixed(2):"",localStorage.freeSpace=null!=l?parseFloat(l).toFixed(2):"",localStorage.autoUpdateExpiration=i,localStorage.lastOSCheck=e,localStorage.googleOrganisationalUnit=s)}H(localStorage.deviceID,localStorage.accountID,localStorage.region,t),R(!0,localStorage.accountID,localStorage.siteID,localStorage.region,null)}(a.responseText,e)}}(t)):H(localStorage.deviceID,localStorage.accountID,localStorage.region,t)}(JSON.parse(e),t)}))}}function s(e,t,a){var t=JSON.stringify({DeviceID:e,AccountID:t}),o=new XMLHttpRequest;C(localStorage.region)||"nsclassroomapi"==localStorage.region?o.open("POST","https://nsclassroomactivitymonitor.azurewebsites.net/api/Devices/getConfig"):o.open("POST","https://activitymonitor-"+localStorage.region+".classroom.cloud/api/Devices/getConfig"),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","application/json"),o.send(t),o.onreadystatechange=function(){this.readyState===o.DONE&&200===this.status&&function(e,t){P.altdebug("448 cicreg ACTIVITY MONITOR CONFIG: \n"+e);var a=JSON.parse(e);var o=a.activityMonitorEnabled,r=a.allowedIPs,n=(a.allowedSSIDs,a.appAllowedDates),l=a.appAllowedTimes;localStorage.activityMonitorChanged=!0,null!=l&&function(e){let t=(new Date).getDay(),a=e.split(";")[t];""!=a&&null!=a&&(inHoursEndTime=a.split("-")[1],timeStampEnd=new Date,timeStampEnd.setHours(inHoursEndTime.split(":")[0]),timeStampEnd.setMinutes(inHoursEndTime.split(":")[1]),timeStampEnd.setSeconds(0),timeStampEnd.setMilliseconds(0),localStorage.inHoursEndTime=timeStampEnd,chrome.runtime.sendMessage({storeSync:!0,data:{storedTimes:{timestamp:localStorage.timestampDate,inHoursEndTime:timeStampEnd.getTime()}}}))}(l);localStorage.appAllowedTimes=l;a.appEnabled;var i=a.logEnabled,e=a.webEnabled,l=q(new Date,n,l);localStorage.activityInterval=a.hasOwnProperty("activityInterval")?a.activityInterval:null,localStorage.appAllowedDates=n,localStorage.monitoredActivityMonitorIPs=r,localStorage.activityMonitorEnabled=o,localStorage.logEnabled=i,localStorage.webEnabled=e,localStorage.isWebMonitoringAllowed=1==e&&1==o&&0==l&&S(r,"activitymonitor")&&"18"!=localStorage.getItem("cloudState"),localStorage.isLoginMonitoringAllowed=1==i&&1==o&&0==l&&S(r,"activitymonitor")&&"18"!=localStorage.getItem("cloudState"),P.altdebug("478 cicreg activityMonitorConfig: logEnabled: "+localStorage.logEnabled),P.altdebug("479 cicreg activityMonitorConfig: webEnabled: "+localStorage.webEnabled),P.altdebug("480 cicreg activityMonitorConfig: isWebMonitoringAllowed: "+localStorage.isWebMonitoringAllowed),P.altdebug("481 cicreg activityMonitorConfig: isLoginMonitoringAllowed: "+localStorage.isLoginMonitoringAllowed);o={activityMonitor:{enabled:o,frequency:""!=localStorage.activityInterval&&"null"!=localStorage.activityInterval&&"undefined"!=localStorage.activityInterval&&null!=localStorage.activityInterval?60*parseInt(localStorage.activityInterval):""!=localStorage.acitivitymonitorfrequency&&null!=localStorage.acitivitymonitorfrequency&&"undefined"!=localStorage.acitivitymonitorfrequency?parseInt(localStorage.acitivitymonitorfrequency):1800,runatstartup:1}};P.altdebug("491 cicreg activityMonitorConfig: activityMonitor.frequency: "+o.activityMonitor.frequency),localStorage.configChangedTime=(new Date).getTime(),localStorage.activityMonitorConfigData=JSON.stringify(o),function(t,a){require(["background/confighandler"],function(e){e.update(t,!1),a&&a(),"true"==localStorage.chomegutscalled&&"true"==localStorage.techComponentEnabled&&localStorage.roomspec&&""!=localStorage.roomspec&&(m(localStorage.deviceID,localStorage.accountID),localStorage.chomegutscalled=!1)})}(o,t)}(o.responseText,a)}}function S(e,t){return 1!=J(localStorage.ipaddress,e,t)}function N(e){return 1<<e-1}function f(r,n,l,e){return new Promise(function(e,t){null!=r?(a=JSON.parse(r).deviceID,localStorage.deviceID=a,localStorage.accountID=n,localStorage.region=l):(a=localStorage.deviceID,n=localStorage.accountID,l=localStorage.region);var a={deviceID:a,accountID:n},a=JSON.stringify(a),o=new XMLHttpRequest;C(l)?o.open("POST",l+"/api/Devices/getConfig"):"nsclassroomapi"==l?o.open("POST","https://nsclassroomapi.azurewebsites.net/api/Devices/getConfig"):o.open("POST","https://api-"+l+".classroom.cloud/api/Devices/getConfig"),o.setRequestHeader("Content-Type","application/json"),"{}"!=a&&o.send(a),o.onreadystatechange=function(){var w;this.readyState===o.DONE&&200===this.status&&(P.altdebug("914 getConfig success"),w=o.responseText,new Promise(function(e,t){P.altdebug("935 cicreg CONFIG DATA: \n"+w);var a=JSON.parse(w),o=a.client,r=o.roomspec,n=o.altemaildomain,l=o.disablechatmenu,i=o.disablefulldesktopview,s=o.disablerequesthelp,c=o.useracknowledge,g=o.shared,d=o.classcode,u=o.connectedtext,p=o.viewedtext;localStorage.disablefulldesktopview=null==i?0:i,"1"==i&&chrome.runtime.sendMessage({endScreenshare:!0}),localStorage.connectedtext=u,localStorage.isConnectedTextSet=""!=u&&null!=u,localStorage.viewedtext=p,localStorage.isViewedTextSet=""!=p&&null!=p;var S=a.cloud,f=S.department,m=S.ipaddress,v=S.site,y=S.timezoneid,h=S.utctime,A=S.googleAdmin,D="True"==S.aupRulesEnabled;P.altdebug("962 cicreg CONFIG DATA - CLOUD.IPADDRESS: "+m),localStorage.techComponentEnabled=D,localStorage.altemaildomain=n,localStorage.googleAdminAccess=1==A,localStorage.classcode=d,localStorage.storedChannel=r;o=S.expired,u=S.allowedips,p=S.allowedtimes,D=S.alloweddates;null!=S.deviceID&&(localStorage.deviceID=S.deviceID),localStorage.allowedConnectionIPs=u,localStorage.allowedtimes=p,localStorage.alloweddates=D;n=a.http,A=n.gatewayAddress,d=n.key,S=n.port,a=n.secondaryGateway,n=null!=a?a.split(":")[0]:"Not available",a=null!=a?a.split(":")[1]:"Not available";localStorage.secondaryAddress=n,localStorage.secondaryPort=a,localStorage.disableChat=void 0!==l?l:"0",chrome.runtime.sendMessage({storeLocal:!0,data:{disablefulldesktop:void 0!==i?i:"0"}}),localStorage.disableHelpRequest=void 0!==s?s:"0",localStorage.shared=void 0!==g?g:"0",localStorage.department=f,null!=localStorage.externalIPFromGateway&&"undefined"!=localStorage.externalIPFromGateway||(localStorage.ipaddress=m),localStorage.site=v,localStorage.timezoneid=y,localStorage.utctime=h,localStorage.gatewayAddress=A,chrome.runtime.sendMessage({storeLocal:!0,data:{gatewayAddress:A}}),localStorage.gatewayKey=d,localStorage.port=S,chrome.runtime.sendMessage({storeLocal:!0,data:{port:S}}),localStorage.useracknowledge=c,localStorage.roomspec=r,P.altdebug("1039 assigning ROOMSPEC: "+localStorage.roomspec),localStorage.storedRoomSpec=r,chrome.runtime.sendMessage({storeLocal:!0,data:{roomSpec:r}}),P.altdebug("1042 - ConfigData roomspec: "+localStorage.roomspec),localStorage.expired="0",p=null!=o&&"1"==o?(localStorage.expired="1","18"):""===r?"18":null!=u&&""!=u&&J(m,u,"privacy")?"20":q(h,D,p)?"21":"1",chrome.runtime.sendMessage({storeLocal:!0,data:{cloudState:p}}),"18"==(localStorage.cloudState=p)?b.core.badge.updateBadgeColour("disconnected"):"1"==p?b.core.badge.updateBadgeColour("connected_NCS"):b.core.badge.updateBadgeColour("cloudstate"),"1"==i?(localStorage.useLegacyThumbnail=!0,chrome.runtime.sendMessage({storeLocal:!0,data:{useLegacyThumbnail:!0}})):(localStorage.useLegacyThumbnail=!1,chrome.runtime.sendMessage({storeLocal:!0,data:{useLegacyThumbnail:!1}})),"0"==localStorage.shared?localStorage.shared=!1:localStorage.shared=!0,T.instance&&localStorage.roomSpec&&T.instance.STATUS(localStorage.roomSpec,0),I.updateDevice().then(function(){setTimeout(function(){E(localStorage.deviceID,localStorage.accountID,localStorage.region)},2e3)})}).then(e))}})}function m(i,s){return new Promise(function(e,t){var a=JSON.stringify({accountId:s,deviceId:i,getMicrosoftAdRequirements:!1,getGoogleRequirements:!0}),r=new XMLHttpRequest;C(localStorage.region)?r.open("POST",localStorage.region+"/api/Devices/getAcceptableUsagePoliciesPreflight"):"nsclassroomapi"==localStorage.region?r.open("POST","https://nsclassroomapi.azurewebsites.net/api/Devices/getAcceptableUsagePoliciesPreflight"):r.open("POST","https://api-"+localStorage.region+".classroom.cloud/api/Devices/getAcceptableUsagePoliciesPreflight"),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.send(a),r.onreadystatechange=function(){var e,o,n,l;this.readyState===r.DONE&&200===this.status&&(e=JSON.parse(r.responseText),o=i,n=s,l=e.googleOrganisationalUnits,new Promise(function(e,t){c=[],g=[],d=[],null!=localStorage.googleOrganisationalUnit&&null!=l&&l.includes(localStorage.googleOrganisationalUnit)&&d.push(localStorage.googleOrganisationalUnit);var a={deviceID:o,accountID:n,deviceDetails:{username:localStorage.userName,email:localStorage.fullemail,deviceName:""!=localStorage.deviceHostname?localStorage.deviceHostname:localStorage.serialNumber,publicIpAddress:"undefined"!=localStorage.ipaddress&&null!=localStorage.ipaddress?localStorage.ipaddress:"",location:localStorage.location,googleOrganisationalUnits:d,deviceGroup:localStorage.roomSpec,osName:"ChromeOS",signedInUser:localStorage.userName}},a=JSON.stringify(a),r=new XMLHttpRequest;C(localStorage.region)?r.open("POST",localStorage.region+"/api/Devices/getAcceptableUsagePolicies"):"nsclassroomapi"==localStorage.region?r.open("POST","https://nsclassroomapi.azurewebsites.net/api/Devices/getAcceptableUsagePolicies"):r.open("POST","https://api-"+localStorage.region+".classroom.cloud/api/Devices/getAcceptableUsagePolicies"),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.send(a),r.onreadystatechange=function(){var o;this.readyState===r.DONE&&200===this.status&&(o=r.responseText,new Promise(function(e,t){var a=JSON.parse(o);0<a.length&&(index=0,y(a,index,e))}).then(v))}}))}})}function v(e){var t;0<c.length&&(e.shouldReset?index=0:index+=1,t=c[index],e=index,localStorage.policyTextRTF=t.policyTextRTF,localStorage.policyId=t.policyId,localStorage.policyName=t.policyName,localStorage.acknowledgement=t.acknowledgement,localStorage.index=e,b.core.showUserAcceptancePolicy(),index>=c.length&&(c=[]))}function r(e){e={policyId:e.policyId,signedTime:b.core.dateToLocaleISOString(new Date),signedName:null!=e.signedName?e.signedName:""};g.push(e),g.length==c.length?(localStorage.uapsSent=!0,function(e){var e={deviceID:localStorage.deviceID,accountID:localStorage.accountID,signedInUser:localStorage.userName,signedInUserFriendlyName:"true"==localStorage.googleAdminAccess&&"true"==localStorage.isManaged&&null!=localStorage.name?localStorage.name:localStorage.userName.split("@")[0].toUpperCase(),signatures:e},t=JSON.stringify(e),a=new XMLHttpRequest;C(localStorage.region)?a.open("POST",localStorage.region+"/api/Devices/sendAcceptableUsagePolicySignatures"):"nsclassroomapi"==localStorage.region?a.open("POST","https://nsclassroomapi.azurewebsites.net/api/Devices/sendAcceptableUsagePolicySignatures"):a.open("POST","https://api-"+localStorage.region+".classroom.cloud/api/Devices/sendAcceptableUsagePolicySignatures");a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Accept","application/json"),a.send(t),g=[],a.onreadystatechange=function(){this.readyState===a.DONE&&204===this.status?(chrome.runtime.sendMessage({close:!0}),localStorage.policiesUnsent=null):0==this.status&&(localStorage.policiesUnsent=t)}}(g)):v(!1)}function y(t,a,o){var e,r;a<t.length?(e={deviceID:localStorage.deviceID,accountID:localStorage.accountID},e=JSON.stringify(e),r=new XMLHttpRequest,C(localStorage.region)?r.open("POST",localStorage.region+"/api/Devices/getAcceptableUsagePolicy/"+t[a].policyId):"nsclassroomapi"==localStorage.region?r.open("POST","https://nsclassroomapi.azurewebsites.net/api/Devices/getAcceptableUsagePolicy/"+t[a].policyId):r.open("POST","https://api-"+localStorage.region+".classroom.cloud/api/Devices/getAcceptableUsagePolicy/"+t[a].policyId),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.send(e),r.onreadystatechange=function(){var e;this.readyState===r.DONE&&200===this.status&&(e=r.responseText,message=e,function(e,t,a,o){t={acknowledgement:e[a].acknowledgement,policyId:e[a].policyId,logoutUser:e[a].logoutUser,userCanDecline:e[a].userCanDecline,policyName:e[a].policyName,policyTextRTF:t},c.push(t),y(e,a+1,o)}(t,message,a,o))}):o({shouldReset:!0})}function E(e,t,a,o){var t=JSON.stringify({DeviceID:e,AccountID:t}),r=new XMLHttpRequest;C(a)?r.open("POST",a+"/api/Devices/getInternetRestrictionsConfig"):"nsclassroomapi"==a?r.open("POST","https://nsclassroomapi.azurewebsites.net/api/Devices/getInternetRestrictionsConfig"):r.open("POST","https://api-"+a+".classroom.cloud/api/Devices/getInternetRestrictionsConfig"),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.send(t),r.onreadystatechange=function(){var u;this.readyState===r.DONE&&200===this.status&&(u=r.responseText,new Promise(function(e,t){P.altdebug("1452 cicreg INTERNET RESTRICTIONS DATA: \n"+u);var a=JSON.parse(u),o=a.internetRestrictionsEnabled,r=a.internetRestrictionsMode,n=a.allowSafeguardingResources;let l=a.allowedIpAddresses;var i=a.whitelistedUrls;localStorage.internetRestrictionsEnabled=o,localStorage.internetRestrictionsMode=r,localStorage.allowSafeguardingResources=n,localStorage.whitelistedUrls=i,localStorage.internetRestrictedIPs=l?l.join(";"):"";let s=[];if(null!=a.termDates)for(var c of a.termDates)temp={startDate:c.startDate,endDate:c.endDate},s.push(temp);localStorage.termDatesIR=JSON.stringify(s);let g=[];if(null!=a.websites)for(var d of a.websites)temp={siteID:d.siteID,websiteURL:d.websiteURL,friendlyName:d.friendlyName,status:d.status},g.push(temp);localStorage.websitesIR=JSON.stringify(g);i=a.blockAllHours;i&&(blockhours={monday:i.monday,tuesday:i.tuesday,wednesday:i.wednesday,thursday:i.thursday,friday:i.friday,saturday:i.saturday,sunday:i.sunday},localStorage.blockAllHours=JSON.stringify(blockhours));i=a.restrictedHours;i&&(restrictedhours={monday:i.monday,tuesday:i.tuesday,wednesday:i.wednesday,thursday:i.thursday,friday:i.friday,saturday:i.saturday,sunday:i.sunday},localStorage.restrictedHours=JSON.stringify(restrictedhours));a=a.approvedHours;a&&(approvedhours={monday:a.monday,tuesday:a.tuesday,wednesday:a.wednesday,thursday:a.thursday,friday:a.friday,saturday:a.saturday,sunday:a.sunday},localStorage.approvedHours=JSON.stringify(approvedhours)),p(localStorage.deviceID,localStorage.accountID,localStorage.region,e)}))}}function h(e){return localStorage.blockAllHours&&w(JSON.parse(localStorage.blockAllHours)[e.toLowerCase()])}function A(e){return localStorage.approvedHours&&w(JSON.parse(localStorage.approvedHours)[e.toLowerCase()])}function D(e){return localStorage.restrictedHours&&w(JSON.parse(localStorage.restrictedHours)[e.toLowerCase()])}function w(e){for(var t of e)if(startTime=t.startTime,endTime=t.endTime,function(e,t){let a=new Date,o=e.split(":")[0],r=e.split(":")[1],n=t.split(":")[0],l=t.split(":")[1],i=new Date;i.setHours(o,r,0);let s=new Date;return s.setHours(n,l,0),a>i&&a<s}(startTime,endTime))return!0;return!1}function q(e,a,t){var o=new Date(e);let r=[];if(!(void 0!==a&&"undefined"!=a&&null!=a&&""!=a||null!=t&&"undefined"!=t&&null!=t&&""!=t&&"00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59"!=t))return!1;if(null!=a&&"undefined"!=a&&null!=a&&""!=a&&(null==t||"undefined"==t||null==t||""==t||"00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59"==t)){for(r=M(a),i=0;i<r.length;i++)if(0==x(r[i],o))return!1;return!0}if(null!=a&&"undefined"!=a&&null!=a&&""!=a&&null!=t&&"undefined"!=t&&null!=t&&""!=t&&"00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59"!=t){r=M(a);let e=0,t=0;for(i=0;i<r.length;i++)1==x(r[i],o)?t+=1:e+=1;if(0==e)return!0}a=[];if(void 0===t||"undefined"==t||""==t||"00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59;00:00-23:59"==t)return!1;a=t.split(";"),o.getDay(),t=o.getDay();return""==a[parseInt(t)]||1==function(e,t){let a=e.split("-")[0],o=e.split("-")[1],r=a.split(":")[0],n=a.split(":")[1].split(" ")[0],l=o.split(":")[0],i=o.split(":")[1].split(" ")[0],s=new Date;s.setHours(r,n,0);let c=new Date;return c.setHours(l,i,0),!(t>s&&t<c)}(a[parseInt(t)],o)}function x(e,t){if(""===e)return!0;var a=e.split(">")[0],e=e.split(">")[1];let o=new Date(a),r=new Date(e);a=new Date(r.setHours(23,59,59,0)),e=new Date(o.setHours(0,0,0,0)),new Date(t),t=new Date;return!(e<=t&&t<=a)}function M(e){return e.split(";")}function U(e){return e.split(";")}function J(e,t,a){let o=[],r=!1;if(""==t||void 0===t||"undefined"==t||null===t){if(""==t||void 0===t||"undefined"==t)return!1;"privacy"==a&&(o=U(localStorage.getItem("allowedConnectionIPs"))),"activitymonitor"==a&&(o=U(localStorage.getItem("monitoredActivityMonitorIPs"))),"onlinesafety"==a&&(o=U(localStorage.getItem("monitoredEsafetyIPs"))),"internetrestrictions"==a&&(o=U(localStorage.getItem("internetRestrictedIPs")))}else o=U(t),"privacy"==a&&localStorage.setItem("allowedConnectionIPs",t),"activitymonitor"==a&&localStorage.setItem("monitoredActivityMonitorIPs",t),"onlinesafety"==a&&localStorage.setItem("monitoredEsafetyIPs",t),"internetrestrictions"==a&&localStorage.setItem("internetRestrictedIPs",t);for(i=0;i<o.length;i++){if(!function(e,t){let a,o;return 2==t.split("-").length?(a=t.split("-")[0],o=t.split("-")[1],!(B(a)<B(e)&&B(o)>B(e))):(a=t,"255"===a.split(".")[3]?(a=a.split(".")[0]+a.split(".")[1]+a.split(".")[2]+"0",o=a.split(".")[0]+a.split(".")[1]+a.split(".")[2]+"255",!(B(a)<B(e)&&B(o)>B(e))):!(B(a)==B(e)))}(e,o[i]))return r=!1,r;r=!0}return r}function B(e){return Number(e.split(".").map(e=>("000"+e).substr(-3)).join(""))}return chrome.runtime.onMessage.addListener(function(e){1==e.retrieveReportConcernDialogConfig&&(o(localStorage.deviceID,!1,!0),setTimeout(function(){o(localStorage.deviceID,!0,!0)},100))}),chrome.runtime.onMessage.addListener(function(e){1==e.sendReportConcern&&e.concernData&&t.priority.enqueue(e.concernData)}),chrome.runtime.onMessage.addListener(function(e,t,a){1==e.uapAcknowledgment&&r(e)}),{cic:a}});