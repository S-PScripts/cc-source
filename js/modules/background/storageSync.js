define(["background/storage-managed"],function(r){var t={};function e(n,e){return n[e.k]=e.v,n}return{set:function(r){return new Promise(function(n,e){chrome.runtime.sendMessage({storeSync:!0,data:r},function(){chrome.runtime.lastError?e(chrome.runtime.lastError.message):n()})})},get:function(t){var n=new Promise(function(e){chrome.runtime.sendMessage({getSync:!0,data:t},function(n){e(n)})});if(!r.capable)return n;var e=new Promise(function(e){chrome.storage.managed.get(t,function(n){e(n)})});return new Promise(function(r){Promise.all([n,e]).then(function(n){var e=n[0],n=n[1];n&&n[t]?(n[t].managed=!0,r(n)):r(e)})})},remove:function(e){return new Promise(function(n){chrome.runtime.sendMessage({removeFromSync:!0,data:e},function(){n()})})},listen:function(n){chrome.storage.onChanged.addListener(n)},sparse:{deflate:function(t){return Object.keys(t).map(function(n,e,r){return{k:n,v:t[n]}})},inflate:function(n){return n.reduce(e,[])}},handlers:{set:function(n,e){t[n]&&delete t[n],e&&(t[n]=e)},list:t},handler:function(n){t[n.key]instanceof Function&&(fn=t[n.key],fn(n))}}});