define(["background/storage-managed"],function(t){var r={};function e(n,e){return n[e.k]=e.v,n}return{set:function(n){return new Promise(function(e,t){chrome.runtime.sendMessage({storeLocal:!0,data:n},function(n){n?e():t(chrome.runtime.lastError.message)})})},get:function(r){var n=new Promise(function(e){chrome.runtime.sendMessage({getLocal:!0,data:r},function(n){e(n)})});if(!t.capable)return n;var e=new Promise(function(e){chrome.storage.managed.get(r,function(n){e(n)})});return new Promise(function(t){Promise.all([n,e]).then(function(n){var e=n[0],n=n[1];n&&n[r]?(n[r].managed=!0,t(n)):t(e)})})},remove:function(e){return new Promise(function(n){chrome.runtime.sendMessage({removeFromLocal:!0,data:e},function(){n()})})},listen:function(n){chrome.runtime.sendMessage({storageOnChanged:!0,data:{}},function(){n()})},sparse:{deflate:function(r){return Object.keys(r).map(function(n,e,t){return{k:n,v:r[n]}})},inflate:function(n){return n.reduce(e,[])}},handlers:{set:function(n,e){r[n]&&delete r[n],e&&(r[n]=e)},list:r},handler:function(n){r[n.key]instanceof Function&&(fn=r[n.key],fn(n))}}});