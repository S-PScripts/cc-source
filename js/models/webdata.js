define(["background/tabActions","models/windows","models/tabs","models/sites","background/storageSync"],function(e,t,r,s,n){var i={},a=void 0;function c(){o(),window.clearInterval(a),a=i.frequency?window.setInterval(o,1e3*i.frequency):window.setInterval(o,6e4)}function o(){return new Promise(function(n){i.hasOwnProperty("enabled")&&i.enabled&&chrome.runtime.sendMessage({queryTabs:!0,tabData:{active:!0}},function(e){e.map(u).map(function(e){t.focus(e.windowId)}),n()})})}function u(e){return s.create(e),r.create(e.id),e.tabId=e.id,r.events.activate(e),e}return{internet:function(){return new Promise(function(e,n){e({internet:s.array()})})},setRefreshInterval:c,persist:function(){t.persistence.save(),r.persistence.save()},update:o,config:i,clearSites:function(){new Promise(function(n){var t=Object.keys(r.keyed).map(function(e){return r.keyed[e].id});chrome.runtime.sendMessage({queryTabs:!0,tabData:{}},function(e){0<e.length&&(presentTabs=e.map(function(e){return e.id}),t.forEach(function(e){presentTabs.includes(e)||r.events.remove(e)})),n()})}),s.archiveDestroyed(),s.clearArchive()},configure:function(e){e.frequency&&(e={updateInterval:{seconds:e.frequency}},n.set({options:e})),c()},persistWeb:function(){s.persistence.save()}}});